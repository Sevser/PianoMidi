(function(e){function t(t){for(var n,r,d=t[0],s=t[1],c=t[2],p=0,m=[];p<d.length;p++)r=d[p],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&m.push(o[r][0]),o[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);u&&u(t);while(m.length)m.shift()();return a.push.apply(a,c||[]),i()}function i(){for(var e,t=0;t<a.length;t++){for(var i=a[t],n=!0,d=1;d<i.length;d++){var s=i[d];0!==o[s]&&(n=!1)}n&&(a.splice(t--,1),e=r(r.s=i[0]))}return e}var n={},o={app:0},a=[];function r(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/PianoMidi/";var d=window["webpackJsonp"]=window["webpackJsonp"]||[],s=d.push.bind(d);d.push=t,d=d.slice();for(var c=0;c<d.length;c++)t(d[c]);var u=s;a.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"1b52":function(e,t,i){},"324e":function(e,t,i){"use strict";i("9b50")},4080:function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("7a23"),o={class:"app container"};function a(e,t,i,a,r,d){var s=Object(n["m"])("canvas-backdrop"),c=Object(n["m"])("Piano");return Object(n["i"])(),Object(n["f"])("div",o,[Object(n["g"])(s),Object(n["g"])(c)])}var r=i("b85c"),d=(i("4ec9"),i("d3b7"),i("3ca3"),i("ddb0"),i("b0c0"),i("159b"),i("5530")),s=(i("d81d"),i("7db0"),[{midiId:108,pianoKey:"88",NoteName:"C8",freq:4186.01},{midiId:107,pianoKey:"87",NoteName:"B7",freq:3951.07},{midiId:106,pianoKey:"86",NoteName:"A#7/Bb7",freq:3729.31},{midiId:105,pianoKey:"85",NoteName:"A7",freq:3520},{midiId:104,pianoKey:"84",NoteName:"G#7/Ab7",freq:3322.44},{midiId:103,pianoKey:"83",NoteName:"G7",freq:3135.96},{midiId:102,pianoKey:"82",NoteName:"F#7/Gb7",freq:2959.96},{midiId:101,pianoKey:"81",NoteName:"F7",freq:2793.83},{midiId:100,pianoKey:"80",NoteName:"E7",freq:2637.02},{midiId:99,pianoKey:"79",NoteName:"D#7/Eb7",freq:2489.02},{midiId:98,pianoKey:"78",NoteName:"D7",freq:2349.32},{midiId:97,pianoKey:"77",NoteName:"C#7/Db7",freq:2217.46},{midiId:96,pianoKey:"76",NoteName:"C7",freq:2093},{midiId:95,pianoKey:"75",NoteName:"B6",freq:1975.53},{midiId:94,pianoKey:"74",NoteName:"A#6/Bb6",freq:1864.66},{midiId:93,pianoKey:"73",NoteName:"A6",freq:1760},{midiId:92,pianoKey:"72",NoteName:"G#6/Ab6",freq:1661.22},{midiId:91,pianoKey:"71",NoteName:"G6",freq:1567.98},{midiId:90,pianoKey:"70",NoteName:"F#6/Gb6",freq:1479.98},{midiId:89,pianoKey:"69",NoteName:"F6",freq:1396.91},{midiId:88,pianoKey:"68",NoteName:"E6",freq:1318.51},{midiId:87,pianoKey:"67",NoteName:"D#6/Eb6",freq:1244.51},{midiId:86,pianoKey:"66",NoteName:"D6",freq:1174.66},{midiId:85,pianoKey:"65",NoteName:"C#6/Db6",freq:1108.73},{midiId:84,pianoKey:"64",NoteName:"C6",freq:1046.5},{midiId:83,pianoKey:"63",NoteName:"B5",freq:987.77},{midiId:82,pianoKey:"62",NoteName:"A#5/Bb5",freq:932.33},{midiId:81,pianoKey:"61",NoteName:"A5",freq:880},{midiId:80,pianoKey:"60",NoteName:"G#5/Ab5",freq:830.61},{midiId:79,pianoKey:"59",NoteName:"G5",freq:783.99},{midiId:78,pianoKey:"58",NoteName:"F#5/Gb5",freq:739.99},{midiId:77,pianoKey:"57",NoteName:"F5",freq:698.46},{midiId:76,pianoKey:"56",NoteName:"E5",freq:659.26},{midiId:75,pianoKey:"55",NoteName:"D#5/Eb5",freq:622.25},{midiId:74,pianoKey:"54",NoteName:"D5",freq:587.33},{midiId:73,pianoKey:"53",NoteName:"C#5/Db5",freq:554.37},{midiId:72,pianoKey:"52",NoteName:"C5",freq:523.25},{midiId:71,pianoKey:"51",NoteName:"B4",freq:493.88},{midiId:70,pianoKey:"50",NoteName:"A#4/Bb4",freq:466.16},{midiId:69,pianoKey:"49",NoteName:"A4 concert pitch",freq:440},{midiId:68,pianoKey:"48",NoteName:"G#4/Ab4",freq:415.3},{midiId:67,pianoKey:"47",NoteName:"G4",freq:392},{midiId:66,pianoKey:"46",NoteName:"F#4/Gb4",freq:369.99},{midiId:65,pianoKey:"45",NoteName:"F4",freq:349.23},{midiId:64,pianoKey:"44",NoteName:"E4",freq:329.63},{midiId:63,pianoKey:"43",NoteName:"D#4/Eb4",freq:311.13},{midiId:62,pianoKey:"42",NoteName:"D4",freq:293.66},{midiId:61,pianoKey:"41",NoteName:"C#4/Db4",freq:277.18},{midiId:60,pianoKey:"40",NoteName:"C4 (middle C)",freq:261.63},{midiId:59,pianoKey:"39",NoteName:"B3",freq:246.94},{midiId:58,pianoKey:"38",NoteName:"A#3/Bb3",freq:233.08},{midiId:57,pianoKey:"37",NoteName:"A3",freq:220},{midiId:56,pianoKey:"36",NoteName:"G#3/Ab3",freq:207.65},{midiId:55,pianoKey:"35",NoteName:"G3",freq:196},{midiId:54,pianoKey:"34",NoteName:"F#3/Gb3",freq:185},{midiId:53,pianoKey:"33",NoteName:"F3",freq:174.61},{midiId:52,pianoKey:"32",NoteName:"E3",freq:164.81},{midiId:51,pianoKey:"31",NoteName:"D#3/Eb3",freq:155.56},{midiId:50,pianoKey:"30",NoteName:"D3",freq:146.83},{midiId:49,pianoKey:"29",NoteName:"C#3/Db3",freq:138.59},{midiId:48,pianoKey:"28",NoteName:"C3",freq:130.81},{midiId:47,pianoKey:"27",NoteName:"B2",freq:123.47},{midiId:46,pianoKey:"26",NoteName:"A#2/Bb2",freq:116.54},{midiId:45,pianoKey:"25",NoteName:"A2",freq:110},{midiId:44,pianoKey:"24",NoteName:"G#2/Ab2",freq:103.83},{midiId:43,pianoKey:"23",NoteName:"G2",freq:98},{midiId:42,pianoKey:"22",NoteName:"F#2/Gb2",freq:92.5},{midiId:41,pianoKey:"21",NoteName:"F2",freq:87.31},{midiId:40,pianoKey:"20",NoteName:"E2",freq:82.41},{midiId:39,pianoKey:"19",NoteName:"D#2/Eb2",freq:77.78},{midiId:38,pianoKey:"18",NoteName:"D2",freq:73.42},{midiId:37,pianoKey:"17",NoteName:"C#2/Db2",freq:69.3},{midiId:36,pianoKey:"16",NoteName:"C2",freq:65.41},{midiId:35,pianoKey:"15",NoteName:"B1",freq:61.74},{midiId:34,pianoKey:"14",NoteName:"A#1/Bb1",freq:58.27},{midiId:33,pianoKey:"13",NoteName:"A1",freq:55},{midiId:32,pianoKey:"12",NoteName:"G#1/Ab1",freq:51.91},{midiId:31,pianoKey:"11",NoteName:"G1",freq:49},{midiId:30,pianoKey:"10",NoteName:"F#1/Gb1",freq:46.25},{midiId:29,pianoKey:"9",NoteName:"F1",freq:43.65},{midiId:28,pianoKey:"8",NoteName:"E1",freq:41.2},{midiId:27,pianoKey:"7",NoteName:"D#1/Eb1",freq:38.89},{midiId:26,pianoKey:"6",NoteName:"D1",freq:36.71},{midiId:25,pianoKey:"5",NoteName:"C#1/Db1",freq:34.65},{midiId:24,pianoKey:"4",NoteName:"C1",freq:32.7},{midiId:23,pianoKey:"3",NoteName:"B0",freq:30.87},{midiId:22,pianoKey:"2",NoteName:"A#0/Bb0",freq:29.14},{midiId:21,pianoKey:"1",NoteName:"A0",freq:27.5}]),c=s.map((function(e){return Object(d["a"])({},e)})),u={getNoteByMIDINumber:function(e){return s.find((function(t){return t.midiId===e}))}},p={class:"container"};function m(e,t,i,o,a,r){var d=Object(n["m"])("white-button");return Object(n["i"])(),Object(n["f"])("div",p,[(Object(n["i"])(!0),Object(n["f"])(n["a"],null,Object(n["l"])(a.whites,(function(e){return Object(n["i"])(),Object(n["d"])(d,{key:e.NoteName,button:e},null,8,["button"])})),128))])}i("4de4");function l(e,t,i,o,a,r){var d=Object(n["m"])("black-button");return Object(n["i"])(),Object(n["f"])("div",{onMousedown:t[0]||(t[0]=Object(n["n"])((function(){return r.clickButton&&r.clickButton.apply(r,arguments)}),["stop","prevent"])),onMouseenter:t[1]||(t[1]=Object(n["n"])((function(){return r.clickButton&&r.clickButton.apply(r,arguments)}),["stop","prevent"])),onMouseup:t[2]||(t[2]=Object(n["n"])((function(e){return a.pressed=!1}),["stop","prevent"])),onMouseleave:t[3]||(t[3]=Object(n["n"])((function(e){return a.pressed=!1}),["stop","prevent"])),class:Object(n["h"])([{active:r.active,pressed:a.pressed},"white-button-container"])},[r.hasNoteDies?(Object(n["i"])(),Object(n["d"])(d,{key:0,button:i.button.noteDies},null,8,["button"])):Object(n["e"])("",!0)],34)}var f=i("4978"),h=i.n(f),N={$on:function(){return h.a.on.apply(h.a,arguments)},$once:function(){return h.a.once.apply(h.a,arguments)},$off:function(){return h.a.off.apply(h.a,arguments)},$emit:function(){return h.a.emit.apply(h.a,arguments)}};function b(e,t,i,o,a,r){return Object(n["i"])(),Object(n["f"])("div",{onMousedown:t[0]||(t[0]=Object(n["n"])((function(){return r.clickButton&&r.clickButton.apply(r,arguments)}),["stop","prevent"])),onMouseenter:t[1]||(t[1]=Object(n["n"])((function(){return r.clickButton&&r.clickButton.apply(r,arguments)}),["stop","prevent"])),onMouseup:t[2]||(t[2]=Object(n["n"])((function(e){return a.pressed=!1}),["stop","prevent"])),onMouseleave:t[3]||(t[3]=Object(n["n"])((function(e){return a.pressed=!1}),["stop","prevent"])),class:Object(n["h"])([{active:r.active,pressed:a.pressed},"black-button-container"])},null,34)}var y={inject:["activeButtons"],name:"blackButton",components:{},watch:{active:function(e){e&&N.$emit("press:button",Object(d["a"])(Object(d["a"])({},this.topCenterPosition),{},{power:this.activeButtons.value.get(this.button.NoteName)}))}},props:{button:{type:Object,required:!0}},computed:{active:function(){return this.activeButtons.value.has(this.button.NoteName)}},methods:{clickButton:function(){this.pressed=!0,N.$emit("press:button",Object(d["a"])(Object(d["a"])({},this.topCenterPosition),{},{power:100}))}},data:function(){return{pressed:!1,topCenterPosition:{top:null,left:null,width:null,center:null}}},mounted:function(){this.topCenterPosition.top=this.$el.getBoundingClientRect().top,this.topCenterPosition.width=this.$el.getBoundingClientRect().width,this.topCenterPosition.left=this.$el.getBoundingClientRect().left,this.topCenterPosition.center=this.topCenterPosition.left+this.topCenterPosition.width/2}},I=(i("324e"),i("6b0d")),v=i.n(I);const g=v()(y,[["render",b],["__scopeId","data-v-3577ca5f"]]);var q=g,K={inject:["activeButtons"],name:"whiteButton",components:{BlackButton:q},props:{button:{type:Object,required:!0}},watch:{active:function(e){e&&N.$emit("press:button",Object(d["a"])(Object(d["a"])({},this.topCenterPosition),{},{power:this.activeButtons.value.get(this.button.NoteName)}))}},computed:{hasNoteDies:function(){return void 0!==this.button.noteDies},active:function(){return this.activeButtons.value.has(this.button.NoteName)}},methods:{clickButton:function(){this.pressed=!0,N.$emit("press:button",Object(d["a"])(Object(d["a"])({},this.topCenterPosition),{},{power:100}))}},data:function(){return{pressed:!1,topCenterPosition:{top:null,left:null,width:null,center:null}}},mounted:function(){this.topCenterPosition.top=this.$el.getBoundingClientRect().top,this.topCenterPosition.width=this.$el.getBoundingClientRect().width,this.topCenterPosition.left=this.$el.getBoundingClientRect().left,this.topCenterPosition.center=this.topCenterPosition.left+this.topCenterPosition.width/2}};i("e4a4");const B=v()(K,[["render",l],["__scopeId","data-v-035666a2"]]);var w=B,O={name:"Piano",components:{WhiteButton:w},props:{},computed:{},methods:{createWhites:function(e){return e.filter((function(e){return 2===e.NoteName.length})).reverse().map((function(t){return Object(d["a"])(Object(d["a"])({},t),{},{noteDies:e.find((function(e){return e.NoteName[0]===t.NoteName[0]&&e.NoteName[2]===t.NoteName[1]}))})}))}},data:function(){return{whites:this.createWhites(c),notes:c}}};i("5a0f");const j=v()(O,[["render",m],["__scopeId","data-v-2053170e"]]);var A=j,P={ref:"canvas"};function C(e,t,i,o,a,r){return Object(n["i"])(),Object(n["f"])("canvas",P,null,512)}i("7898"),i("0481"),i("4069"),i("f664"),i("cfc3"),i("907a"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("cb29");var D="\nattribute vec2 coordinates;\nuniform mat3 u_matrix;\n\n\nvoid main(void) {\n  vec2 position = (u_matrix * vec3(coordinates, 1)).xy;\n  gl_Position = vec4(position, 0, 1.0);\n}\n",M="\n// fragment shaders don't have a default precision so we need\n// to pick one. mediump is a good default\nprecision mediump float;\n\nvoid main() {\n  // gl_FragColor is a special variable a fragment shader\n  // is responsible for setting\n  gl_FragColor = vec4(1, 0, 0.5, 1); // return reddish-purple\n}",F=240,_={name:"canvasBackdrop",components:{},props:{},computed:{lastButton:function(){return this.lastReleasedButton.value&&this.lastReleasedButton.value.NoteName}},methods:{initWebGL:function(e){var t=null;try{t=e.getContext("webgl")||e.getContext("experimental-webgl")}catch(i){console.error(i)}return t||(alert("Unable to initialize WebGL. Your browser may not support it."),t=null),t},start:function(){if(this.gl=this.initWebGL(this.$refs.canvas),this.gl){this.gl.clearColor(255,255,255,1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);var e=this.createVertexShader(this.gl,D),t=this.createFragmentShader(this.gl,M);this.program=this.gl.createProgram(),this.gl.attachShader(this.program,e),this.gl.attachShader(this.program,t),this.gl.linkProgram(this.program);var i=this.gl.getAttribLocation(this.program,"coordinates"),n=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.useProgram(this.program),this.gl.enableVertexAttribArray(i);var o=3,a=this.gl.FLOAT,r=!1,d=0,s=0;this.gl.vertexAttribPointer(i,o,a,r,d,s)}},createFragmentShader:function(e,t){var i=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(i,t),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(i)),null)},createVertexShader:function(e,t){var i=e.createShader(e.VERTEX_SHADER);return e.shaderSource(i,t),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(i)),null)},handlePressedButton:function(e){var t,i=Math.floor(e.center/window.innerWidth*F),n=this.drawLine.additionalPoints[i],o=e.power/400;t=n+o>.25?.25:n+o,this.drawLine.additionalPoints[i]=t;for(var a=10;a>0;a--){if(i+a<this.drawLine.additionalPoints.length){var r=this.drawLine.additionalPoints[i+a],d=t*Math.tanh((10-a)/19);this.drawLine.additionalPoints[i+a]=r+d>.25?Math.max(r,.25-.05*a):r+d}if(i-a>=0){var s=this.drawLine.additionalPoints[i-a],c=t*Math.tanh((10-a)/19);this.drawLine.additionalPoints[i-a]=s+c>.25?Math.max(s,.25-.05*a):s+c}}},draw:function(){var e=this;this.gl.clearColor(255,255,255,1);var t=null,i=this.drawLine.additionalPoints.map((function(i,n){var o=e.drawLine.additionalPoints[n];return e.drawLine.additionalPoints[n]=Math.fround(.9*o),t=[n/F*2-1,-(e.drawLine.baseHeight/e.gl.canvas.height-o),0],t})).flat();this.cachedArrays.push(new Float32Array(i)),this.cachedArrays.length>50&&this.cachedArrays.shift();for(var n=this.gl.getUniformLocation(this.program,"u_matrix"),o=0;o<this.cachedArrays.length;o++){var a=[1,0,0,0,1,0,0,1.5-o/(this.cachedArrays.length/1.5),0];this.gl.uniformMatrix3fv(n,!1,a),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.cachedArrays[o],this.gl.STATIC_DRAW);var r=this.gl.LINE_STRIP,d=0;this.gl.drawArrays(r,d,F)}}},data:function(){return{ctx:null,intervalId:null,drawLine:new Array(46),cachedArrays:[],step:0,gl:null,program:null}},beforeUnmount:function(){clearInterval(this.intervalId)},mounted:function(){this.$refs.canvas.width=window.innerWidth,this.step=Math.floor(window.innerWidth/F),this.$refs.canvas.height=window.innerHeight,N.$on("press:button",this.handlePressedButton.bind(this)),this.intervalId=setInterval(this.draw.bind(this),100),this.drawLine={baseHeight:window.innerHeight-window.innerWidth/100*26,additionalPoints:new Array(F).fill(0)},this.start()}};const S=v()(_,[["render",C]]);var E=S,L={provide:function(){var e=this;return{activeButtons:Object(n["b"])((function(){return e.activeButtons})),lastReleasedButton:Object(n["b"])((function(){return e.lastReleasedButton}))}},name:"App",components:{CanvasBackdrop:E,Piano:A},data:function(){return{logs:[],pressedButtons:[],lastReleasedButton:null,midi:null,activeButtons:new Map}},methods:{onMIDISuccess:function(e){console.log("MIDI ready!"),this.midi=e,this.listInputsAndOutputs(this.midi),this.startLoggingMIDIInput(this.midi)},onMIDIFailure:function(e){console.log("Failed to get MIDI access - "+e)},listInputsAndOutputs:function(e){var t,i=Object(r["a"])(e.inputs);try{for(i.s();!(t=i.n()).done;){var n=t.value,o=n[1];console.log("Input port [type:'"+o.type+"'] id:'"+o.id+"' manufacturer:'"+o.manufacturer+"' name:'"+o.name+"' version:'"+o.version+"'")}}catch(u){i.e(u)}finally{i.f()}var a,d=Object(r["a"])(e.outputs);try{for(d.s();!(a=d.n()).done;){var s=a.value,c=s[1];console.log("Output port [type:'"+c.type+"'] id:'"+c.id+"' manufacturer:'"+c.manufacturer+"' name:'"+c.name+"' version:'"+c.version+"'")}}catch(u){d.e(u)}finally{d.f()}},onMIDIMessage:function(e){128===e.data[0]?this.activeButtons.delete(u.getNoteByMIDINumber(e.data[1]).NoteName):144===e.data[0]&&(this.lastReleasedButton=u.getNoteByMIDINumber(e.data[1]),this.activeButtons.set(this.lastReleasedButton.NoteName,e.data[2]))},startLoggingMIDIInput:function(e){var t=this;e.inputs.forEach((function(e){e.onmidimessage=t.onMIDIMessage}))}},mounted:function(){navigator.requestMIDIAccess().then(this.onMIDISuccess.bind(this),this.onMIDIFailure.bind(this))}};i("fa2a"),i("ad3b");const R=v()(L,[["render",a],["__scopeId","data-v-271bf90e"]]);var G=R;Object(n["c"])(G,{}).mount("#app")},"5a0f":function(e,t,i){"use strict";i("5a27")},"5a27":function(e,t,i){},"9b50":function(e,t,i){},ad3b:function(e,t,i){"use strict";i("4080")},c7c1:function(e,t,i){},e4a4:function(e,t,i){"use strict";i("c7c1")},fa2a:function(e,t,i){"use strict";i("1b52")}});
//# sourceMappingURL=app.3519695c.js.map